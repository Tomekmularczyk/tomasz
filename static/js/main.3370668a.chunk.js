(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{42:function(e,t,n){"use strict";n.r(t);var r,i=n(0),a=n.n(i),o=n(21),c=n.n(o),s=n(4),l=n(2),d=n(46),u=n(47),p=n(43),b=n(44),j=n(14),g=n.n(j);!function(e){e.PI_XBTUSD="PI_XBTUSD",e.PI_ETHUSD="PI_ETHUSD"}(r||(r={}));var h,f=n(22),m=n(23),O=function(e){var t=e.productId,n=e.setInitialSnapshot,r=e.setDeltaMessages,a=e.onError,o=function(){var e=Object(f.a)().numberOfLogicalProcessors,t=void 0===e?2:e,n=Object(m.a)().deviceMemory,r=void 0===n?4:n;return t>2&&r>4?"fast":t>1&&r<=4&&r>=2?"medium":"slow"}(),c=g()("wss://www.cryptofacilities.com/ws/v1",{onError:a}),s=c.sendJsonMessage,l=c.lastJsonMessage,d=c.readyState,u=Object(i.useRef)([]),h=Object(p.a)(t),O=l;Object(i.useEffect)((function(){d===j.ReadyState.OPEN&&(s({event:"unsubscribe",feed:"book_ui_1",product_ids:[h]}),u.current=[],s({event:"subscribe",feed:"book_ui_1",product_ids:[t]}))}),[d,s,t,h]),Object(i.useEffect)((function(){O&&("book_ui_1_snapshot"===O.feed?n(O):function(e){return!!e.asks||!!e.bids}(O)&&O.product_id===t&&u.current.push(O))}),[O,n,t]);var x={slow:3e3,medium:1500,fast:750}[o];return Object(b.a)((function(){r(u.current),u.current=[]}),x),null};!function(e){e[e.Tablet=768]="Tablet"}(h||(h={}));var x=n(45),v=function(){return Object(x.a)("(min-width: ".concat(h.Tablet,"px)"))},w=n(27),C=n(1),_=l.a.div.withConfig({displayName:"OrdersList__Level",componentId:"sc-17gu7rg-0"})(["padding-left:10%;padding-right:5%;padding:4px 5% 4px 10%;"]),y=l.a.div.withConfig({displayName:"OrdersList__ColumnTitlesWrapper",componentId:"sc-17gu7rg-1"})(["border-bottom:1px solid gray;"]),k=l.a.p.withConfig({displayName:"OrdersList__ColumnTitle",componentId:"sc-17gu7rg-2"})(["text-transform:uppercase;color:gray;"]),T=l.a.div.withConfig({displayName:"OrdersList__DataRow",componentId:"sc-17gu7rg-3"})(["display:flex;flex-flow:",";"],(function(e){var t=e.shouldReverseColumns;return void 0!==t&&t?"row-reverse":"row"})),I=l.a.span.withConfig({displayName:"OrdersList__DataCell",componentId:"sc-17gu7rg-4"})(["color:white;width:33.33%;text-align:right;"]),S=l.a.ol.withConfig({displayName:"OrdersList__List",componentId:"sc-17gu7rg-5"})(["list-style:none;"]),F=l.a.span.withConfig({displayName:"OrdersList__Price",componentId:"sc-17gu7rg-6"})(["color:",";"],(function(e){return"green"===e.variant?"green":"red"})),N=new Intl.NumberFormat("en-IN"),P=new Intl.NumberFormat("en-IN",{minimumFractionDigits:2}),D=function(e){var t=100-e.total/e.highestTotal*100,n="left"===e.depthGraphAlign?"270deg":"90deg";switch(e.colorVariant){case"green":return"\n        linear-gradient(\n          ".concat(n,",\n          transparent ").concat(t,"%,\n          #00ff0035 ").concat(t,"%,\n          #00FF0035 100%\n        )\n      ");case"red":return"\n        linear-gradient(\n          ".concat(n,",\n          transparent ").concat(t,"%,\n          #ff000035 ").concat(t,"%,\n          #ff000035 100%\n        )\n      ");default:return}},L=function(e){var t=e.priceLevels,n=e.highestTotal,r=e.colorVariant,i=e.depthGraphAlign,a=e.shouldDisplayColumnTitles,o=void 0!==a&&a,c=e.shouldReverseColumns,s=void 0!==c&&c;return Object(C.jsxs)(C.Fragment,{children:[o?Object(C.jsx)(y,{children:Object(C.jsx)(_,{children:Object(C.jsxs)(T,{shouldReverseColumns:s,children:[Object(C.jsx)(I,{children:Object(C.jsx)(k,{children:"Total"})}),Object(C.jsx)(I,{children:Object(C.jsx)(k,{children:"Size"})}),Object(C.jsx)(I,{children:Object(C.jsx)(k,{children:"Price"})})]})})}):null,Object(C.jsx)(S,{children:t.map((function(e){var t=e.price,a=e.size,o=e.total;return Object(C.jsx)("li",{children:Object(C.jsx)(_,{style:{background:D({total:o,highestTotal:n,depthGraphAlign:i,colorVariant:r})},children:Object(C.jsxs)(T,{shouldReverseColumns:s,children:[Object(C.jsx)(I,{"data-testid":"total",children:N.format(o)}),Object(C.jsx)(I,{"data-testid":"size",children:N.format(a)}),Object(C.jsx)(I,{"data-testid":"price",children:Object(C.jsx)(F,{variant:r,children:P.format(t)})})]})})},t)}))})]})},E=Object(i.memo)((function(e){var t=e.asks,n=e.highestTotal,r=v();return Object(C.jsx)(L,{colorVariant:"red",depthGraphAlign:"left",priceLevels:r?t:Object(w.a)(t).reverse(),highestTotal:n,shouldDisplayColumnTitles:!0,shouldReverseColumns:!0})})),R=Object(i.memo)((function(e){var t=e.bids,n=e.highestTotal,r=v();return Object(C.jsx)(L,{colorVariant:"green",depthGraphAlign:r?"right":"left",priceLevels:t,highestTotal:n,shouldDisplayColumnTitles:r,shouldReverseColumns:!r})})),z=l.a.button.withConfig({displayName:"Footer__ToggleFeedButton",componentId:"sc-t7e0bb-0"})(["background-color:purple;cursor:pointer;border:none;margin:8px auto;color:white;border-radius:2px;padding:4px 8px;letter-spacing:2px;&:active{opacity:0.9;}"]),B=l.a.div.withConfig({displayName:"Footer__Container",componentId:"sc-t7e0bb-1"})(["text-align:center;"]),M=function(e){var t=e.onToggleFeedClick;return Object(C.jsx)(B,{children:Object(C.jsx)(z,{type:"button",onClick:t,children:"Toggle Feed"})})},H=l.a.p.withConfig({displayName:"Spread__SpreadText",componentId:"sc-16roz4g-0"})(["color:gray;margin-right:auto;margin-left:auto;margin:5px auto;"]),U=new Intl.NumberFormat("en-IN",{minimumFractionDigits:1,maximumFractionDigits:1}),A=new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}),G=function(e){var t=e.spreadPoints,n=e.spreadPercentage;return Object(C.jsxs)(H,{children:["Spread: ",U.format(t)," (",A.format(n),"%)"]})},V=l.a.div.withConfig({displayName:"Header__TopHeader",componentId:"sc-eyr6cu-0"})(["display:grid;align-items:center;grid-template-columns:1fr 1fr;border-bottom:2px solid white;color:white;padding:6px 10px;@media (min-width:","px){grid-template-columns:1fr 1fr 1fr;}"],h.Tablet),J=l.a.p.withConfig({displayName:"Header__StatusText",componentId:"sc-eyr6cu-1"})(["text-align:right;"]),X=l.a.button.withConfig({displayName:"Header__RestartButton",componentId:"sc-eyr6cu-2"})(["border:none;background-color:blue;text-transform:uppercase;color:white;margin-top:2px;padding:2px 4px;cursor:pointer;letter-spacing:2px;font-size:0.7rem;"]),W=function(e){var t=e.spreadPoints,n=e.spreadPercentage,r=e.feedStatus,i=e.onRestartFeedClick,a=v();return Object(C.jsxs)(V,{children:[Object(C.jsx)("p",{children:"Order Book"}),a?Object(C.jsx)(G,{spreadPoints:t,spreadPercentage:n}):null,Object(C.jsxs)(J,{children:["Status: ",r," ","error"===r?"\ud83d\udd34":null,Object(C.jsx)("br",{}),"stopped"===r?Object(C.jsx)(X,{onClick:i,children:"restart"}):null,"error"===r?Object(C.jsx)(X,{onClick:i,children:"retry"}):null]})]})},q=n(9),K=n(5),Q=function(e,t,n){return Object.entries(e).sort((function(e,n){var r=Number(e[0]),i=Number(n[0]);return"asc"===t?r-i:i-r})).slice(0,n).map((function(e){return Object(s.a)(e,2)[1]}))},Y=function(e){var t=0;return e.map((function(e){var n=e.price,r=e.size;return{price:n,size:r,total:t+=r}}))},Z=function(e){return e.reduce((function(e,t){return Object(K.a)(Object(K.a)({},e),{},Object(q.a)({},t[0],{price:t[0],size:t[1],total:0}))}),{})},$=function(e,t){var n=Object(K.a)({},e);return t.forEach((function(e){var t=Object(s.a)(e,2),r=t[0],i=t[1];0===i?delete n[r]:n[r]={price:r,size:i,total:0}})),n},ee=l.a.div.withConfig({displayName:"Orderbook__OrdersContainer",componentId:"sc-12znar9-0"})(["display:flex;flex-flow:row wrap;@media (min-width:","px){flex-wrap:nowrap;flex-direction:row-reverse;}"],h.Tablet),te=l.a.div.withConfig({displayName:"Orderbook__OrdersListWrapper",componentId:"sc-12znar9-1"})(["width:100%;@media (min-width:","px){width:50%;}"],h.Tablet),ne=function(e){var t=e.initialSnapshot,n=e.deltas,r=e.onToggleFeedClick,a=e.feedStatus,o=e.onRestartFeedClick,c=v(),l=function(e,t){var n=Object(i.useState)((function(){return Z(e.asks)})),r=Object(s.a)(n,2),a=r[0],o=r[1],c=Object(i.useState)((function(){return Z(e.bids)})),l=Object(s.a)(c,2),d=l[0],u=l[1],p=Object(i.useMemo)((function(){return Y(Q(d,"desc",t))}),[d,t]),b=Object(i.useMemo)((function(){return Y(Q(a,"asc",t))}),[a,t]),j=Object(i.useCallback)((function(e){e.forEach((function(e){o((function(t){return $(t,e.asks||[])})),u((function(t){return $(t,e.bids||[])}))}))}),[]);return Object(i.useEffect)((function(){o(Z(e.asks)),u(Z(e.bids))}),[e]),{asks:b,bids:p,updatePriceLevels:j}}(t,c?25:10),d=l.asks,u=l.bids,p=l.updatePriceLevels;Object(i.useEffect)((function(){p(n)}),[n,p]);var b=Object(s.a)(u,1)[0],j=Object(s.a)(d,1)[0],g=u[u.length-1],h=d[d.length-1],f=g.total>h.total?g.total:h.total,m=j.price-b.price,O=m/b.price*100;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(W,{spreadPoints:m,spreadPercentage:O,feedStatus:a,onRestartFeedClick:o}),Object(C.jsxs)(ee,{children:[Object(C.jsx)(te,{children:Object(C.jsx)(E,{asks:d,highestTotal:f})}),c?null:Object(C.jsx)(G,{spreadPoints:m,spreadPercentage:O}),Object(C.jsx)(te,{children:Object(C.jsx)(R,{bids:u,highestTotal:f})})]}),Object(C.jsx)(M,{onToggleFeedClick:r})]})},re=l.a.main.withConfig({displayName:"App__MainContainer",componentId:"sc-op9nb8-0"})(['background-color:black;font-family:"Courier New",sans-serif;']);var ie=function(){var e=Object(d.a)(),t=Object(i.useState)("feeding"),n=Object(s.a)(t,2),a=n[0],o=n[1],c=Object(i.useState)(r.PI_XBTUSD),l=Object(s.a)(c,2),p=l[0],b=l[1],j=Object(i.useState)(),g=Object(s.a)(j,2),h=g[0],f=g[1],m=Object(i.useState)([]),x=Object(s.a)(m,2),v=x[0],w=x[1];Object(u.a)("blur",(function(){o("stopped")}));var _=Object(i.useCallback)((function(){p===r.PI_ETHUSD?b(r.PI_XBTUSD):b(r.PI_ETHUSD)}),[p]),y=Object(i.useCallback)((function(){o("feeding")}),[]),k=Object(i.useCallback)((function(){o("error")}),[o]);return!1===e.online?Object(C.jsx)(C.Fragment,{children:"you need to have internet connection to see the orderbook"}):Object(C.jsxs)(re,{children:["feeding"===a?Object(C.jsx)(O,{productId:p,setInitialSnapshot:f,setDeltaMessages:w,onError:k}):null,"error"===a?Object(C.jsxs)("p",{children:["We experienced an error loading the orderbook data.",Object(C.jsx)("button",{onClick:y,children:"click here to retry"})]}):null,h?Object(C.jsx)(ne,{initialSnapshot:h,deltas:v,onToggleFeedClick:_,feedStatus:a,onRestartFeedClick:y}):Object(C.jsx)("p",{children:"pretty placeholder"})]})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,48)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),i(e),a(e),o(e)}))};c.a.render(Object(C.jsx)(a.a.StrictMode,{children:Object(C.jsx)(ie,{})}),document.getElementById("root")),ae()}},[[42,1,2]]]);
//# sourceMappingURL=main.3370668a.chunk.js.map